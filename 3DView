(function()%7B(function() %7B%0A%09var tri %3D %7B%0A%09%09menu%3A document.createElement("div")%2C%0A%09%09limit%3A document.createElement("input")%2C%0A%09%09gap%3A document.createElement("input")%2C%0A%09%09sag%3A document.createElement("input")%2C%0A%09%09fov%3A document.createElement("input")%2C%0A%09%09flo%3A document.createElement("input")%2C%0A%09%09off%3A document.createElement("input")%2C%0A%09%09non%3A document.createElement("input")%2C%0A%09%09end%3A document.createElement("input")%2C%0A%09%09tgl%3A document.createElement("input")%2C%0A%09%09cssStatic%3A document.createElement("style")%2C%0A%09%09cssDynamic%3A document.createElement("style")%2C%0A%09%09orientation%3A %7B"yaw"%3A 0%2C "pitch"%3A 0%2C "roll"%3A 0%7D%2C%0A%09%09mouseMove%3A function(e) %7B%0A%09%09%09tri.orientation.yaw %3D -Math.cos(Math.PI * e.clientX %2F innerWidth) * 180 * tri.limit.value%3B%0A%09%09%09tri.orientation.pitch %3D Math.cos(Math.PI * e.clientY %2F innerHeight) * 180 * tri.limit.value%3B%0A%09%09%09tri.updateBody()%3B%0A%09%09%7D%2C%0A%09%09gyroMove%3A function(e) %7B%0A%09%09%09var landscape %3D innerWidth > innerHeight%3B%0A%09%09%09if (landscape) %7B%0A%09%09%09%09tri.orientation.yaw %3D -(e.alpha %2B e.beta)%3B%0A%09%09%09%09tri.orientation.pitch %3D e.gamma - Math.sign(90 - Math.abs(e.beta)) * 90%3B%0A%09%09%09%7D%0A%09%09%09else %7B%0A%09%09%09%09tri.orientation.yaw %3D -(e.alpha %2B e.gamma)%3B%0A%09%09%09%09tri.orientation.pitch %3D e.beta - 90%3B%0A%09%09%09%7D%0A%09%09%09tri.updateBody()%3B%0A%09%09%7D%2C%0A%09%09updateOrigin%3A function(e) %7B%0A%09%09%09document.body.style.transformOrigin %3D (innerWidth %2F 2 %2B pageXOffset) %2B "px " %2B (innerHeight %2F 2 %2B pageYOffset) %2B "px"%3B%0A%09%09%7D%2C%0A%09%09updateBody%3A function() %7B%0A%09%09%09document.body.style.transform %3D "perspective(" %2B Math.pow(2%2C tri.fov.value) %2B "px) translateZ(-" %2B tri.gap.value %2B "px) rotateX(" %2B tri.orientation.pitch %2B "deg) rotateY(" %2B tri.orientation.yaw %2B "deg)"%3B%0A%09%09%7D%2C%0A%09%09updateCSS%3A function() %7B%0A%09%09%09if (tri.non.checked)%0A%09%09%09%09tri.cssDynamic.innerHTML %3D ""%3B%0A%09%09%09else if (tri.off.checked)%0A%09%09%09%09tri.cssDynamic.innerHTML %3D "* %7B transform-style%3A preserve-3d%3B %7D"%3B%0A%09%09%09else %7B%0A%09%09%09%09for (var depth %3D 0%3B document.querySelector("body" %2B " > *".repeat(depth))%3B depth%2B%2B)%3B%0A%09%09%09%09var gap %3D tri.gap.value %2F depth%3B%0A%09%09%09%09var sag %3D -Math.PI * tri.sag.value %2F depth%3B%0A%09%09%09%09tri.cssDynamic.innerHTML %3D %60%0A* %7B%0A%09transform%3A translateZ(%24%7Bgap%7Dpx) rotateX(%24%7Bsag%7Drad)%3B%0A%09transform-style%3A preserve-3d%3B%0A%09transition%3A transform 1s%3B%0A%09outline%3A 1px solid rgba(0%2C 0%2C 0%2C 0.0625)%3B%0A%09%24%7Btri.flo.checked %3F "overflow%3A visible !important%3B" %3A ""%7D%0A%7D%0A*%3Ahover %7B%0A%09transform%3A translateZ(%24%7Bgap * 2%7Dpx) rotateX(%24%7Bsag * 2%7Drad)%3B%0A%09%24%7B!tri.flo.checked %3F "overflow%3A visible%3B" %3A ""%7D%0A%7D%0A%60%3B%0A%09%09%09%7D%0A%09%09%7D%2C%0A%09%09toggle%3A function() %7B%0A%09%09%09if (tri.menu.className %3D%3D "active") %7B%0A%09%09%09%09tri.menu.removeAttribute("class")%3B%0A%09%09%09%7D%0A%09%09%09else %7B%0A%09%09%09%09tri.menu.className %3D "active"%3B%0A%09%09%09%7D%0A%09%09%7D%2C%0A%09%09quit%3A function() %7B%0A%09%09%09window.removeEventListener("deviceorientation"%2C tri.gyroMove)%3B%0A%09%09%09window.removeEventListener("mousemove"%2C tri.mouseMove)%3B%0A%09%09%09window.removeEventListener("scroll"%2C tri.updateOrigin)%3B%0A%09%09%09window.addEventListener("resize"%2C tri.updateOrigin)%3B%0A%09%09%09tri.menu.remove()%3B%0A%09%09%09tri.cssStatic.remove()%3B%0A%09%09%09tri.cssDynamic.remove()%3B%0A%09%09%09document.body.removeAttribute("style")%3B%0A%09%09%7D%2C%0A%09%09newRange%3A function(e%2C label%2C min%2C step%2C max%2C value%2C f) %7B%0A%09%09%09tri.menu.appendChild(e)%3B%0A%09%09%09e.type %3D "range"%3B%0A%09%09%09e.min %3D min%3B%0A%09%09%09e.max %3D max%3B%0A%09%09%09e.step %3D step%3B%0A%09%09%09e.value %3D value%3B%0A%09%09%09e.addEventListener("input"%2C f)%3B%0A%09%09%09tri.menu.appendChild(document.createElement("span")).innerHTML %3D label%3B%0A%09%09%09tri.menu.appendChild(document.createElement("br"))%3B%0A%09%09%7D%2C%0A%09%09newCheckbox%3A function(e%2C label%2C f) %7B%0A%09%09%09tri.menu.appendChild(e)%3B%0A%09%09%09e.type %3D "checkbox"%3B%0A%09%09%09e.addEventListener("click"%2C f)%3B%0A%09%09%09tri.menu.appendChild(document.createElement("span")).innerHTML %3D label%3B%0A%09%09%09tri.menu.appendChild(document.createElement("br"))%3B%0A%09%09%7D%2C%0A%09%09newButton%3A function(e%2C label%2C f) %7B%0A%09%09%09tri.menu.appendChild(e)%3B%0A%09%09%09e.type %3D "button"%3B%0A%09%09%09e.value %3D label%3B%0A%09%09%09e.addEventListener("click"%2C f)%3B%0A%09%09%7D%2C%0A%09%09init%3A function() %7B%0A%09%09%09document.body.parentNode.appendChild(tri.menu).id %3D "tri-menu"%3B%0A%09%09%09tri.newRange(tri.limit%2C "limit"%2C 0%2C 0.03125%2C 1%2C 0.125%2C tri.updateBody)%3B%0A%09%09%09tri.newRange(tri.gap%2C "gap %2F distance"%2C 0%2C 32%2C 512%2C 128%2C function() %7B%0A%09%09%09%09tri.updateCSS()%3B%0A%09%09%09%09tri.updateBody()%3B%0A%09%09%09%7D)%3B%0A%09%09%09tri.newRange(tri.sag%2C "sag"%2C -0.25%2C 0.03125%2C 0.25%2C 0%2C tri.updateCSS)%3B%0A%09%09%09tri.newRange(tri.fov%2C "field of view"%2C 7%2C 1%2C 13%2C 10%2C tri.updateBody)%3B%0A%09%09%09tri.newCheckbox(tri.flo%2C "force overflow"%2C tri.updateCSS)%3B%0A%09%09%09tri.flo.setAttribute("checked"%2C "")%3B%0A%09%09%09tri.newCheckbox(tri.off%2C "flatten layers"%2C tri.updateCSS)%3B%0A%09%09%09tri.newCheckbox(tri.non%2C "flatten everything"%2C tri.updateCSS)%3B%0A%09%09%09tri.newButton(tri.end%2C "Quit"%2C tri.quit)%3B%0A%09%09%09tri.newButton(tri.tgl%2C "â‰¡"%2C tri.toggle)%3B%0A%09%09%09tri.tgl.id %3D "tri-toggle"%3B%0A%09%09%09tri.menu.appendChild(tri.cssStatic).innerHTML %3D %60%0Ahtml%2C body %7B%0A%09transition-property%3A none%3B%0A%09height%3A 100%25%3B%0A%09width%3A 100%25%3B%0A%7D%0Ahtml%2C html%3Ahover%2C %23tri-menu%2C %23tri-menu > *%2C %23tri-menu > *%3Ahover %7B%0A%09transform%3A none%3B%0A%09outline%3A none%3B%0A%09overflow%3A auto !important%3B%0A%09float%3A none%3B%0A%7D%0A%23tri-menu %7B%0A%09position%3A fixed%3B%0A%09top%3A 0%3B%0A%09left%3A 0%3B%0A%09background%3A rgba(0%2C 0%2C 0%2C 0.5)%3B%0A%09color%3A white%3B%0A%09border%3A 1px solid rgba(255%2C 255%2C 255%2C 0.5)%3B%3B%0A%09border-radius%3A 0 0 16px 0%3B%0A%09padding%3A 8px%3B%0A%09transform%3A translate(-100%25%2C -100%25) translate(32px%2C 32px)%3B%0A%7D%0A%23tri-menu.active %7B%0A%09transform%3A none%3B%0A%7D%0A%23tri-toggle %7B%0A%09position%3A absolute%3B%0A%09bottom%3A 0%3B%0A%09right%3A 0%3B%0A%09height%3A 32px%3B%0A%09width%3A 32px%3B%0A%09background%3A transparent%3B%0A%09color%3A white%3B%0A%09border%3A none%3B%0A%09cursor%3A pointer%3B%0A%7D%0A%23tri-menu.active > %23tri-toggle %7B%0A%09background%3A white%3B%0A%09color%3A black%3B%0A%09border-radius%3A 8px 0 0 0%3B%0A%7D%0A%60%3B%0A%09%09%09tri.menu.appendChild(tri.cssDynamic)%3B%0A%09%09%09tri.updateCSS()%3B%0A%09%09%09window.addEventListener("deviceorientation"%2C tri.gyroMove)%3B%0A%09%09%09window.addEventListener("mousemove"%2C tri.mouseMove)%3B%0A%09%09%09window.addEventListener("scroll"%2C tri.updateOrigin)%3B%0A%09%09%09window.addEventListener("resize"%2C tri.updateOrigin)%3B%0A%09%09%09window.scrollBy(0%2C 1)%3B%0A%09%09%7D%0A%09%7D%3B%0A%09tri.init()%3B%0A%7D)()%3B%7D)()%3B
